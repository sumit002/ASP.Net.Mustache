using Mustache;
using System;
using System.Collections.Generic;
using System.Linq;

namespace MustacheConsoleApp
{
    class Program
    {
        #region Properties
        public static string templateTextToRender = "<!DOCTYPE HTML PUBLIC \"-//W3C//DTD HTML 4.01//EN\" \"http://www.w3.org/TR/html4/strict.dtd\">\r\n<!doctype html>\r\n<head>\r\n        \r\n<meta property=\"og:title\" content=\"\">\r\n<meta name=\"viewport\" content=\"width=device-width, initial-scale=1, maximum-scale=1\">\r\n<meta name=\"referrer\" content=\"origin\">        \r\n        <!-- NAME: 1 COLUMN -->\r\n        <!--[if gte mso 15]>\r\n        <xml>\r\n            <o:OfficeDocumentSettings>\r\n            <o:AllowPNG/>\r\n            <o:PixelsPerInch>96</o:PixelsPerInch>\r\n            </o:OfficeDocumentSettings>\r\n        </xml>\r\n        <![endif]-->\r\n        <meta charset=\"UTF-8\">\r\n        <meta http-equiv=\"X-UA-Compatible\" content=\"IE=edge\">\r\n        <meta name=\"viewport\" content=\"width=device-width, initial-scale=1\">\r\n        <title>*Device Error*</title>\r\n        \r\n    <style type=\"text/css\">\r\n\t\tp{\r\n\t\t\tmargin:10px 0;\r\n\t\t\tpadding:0;\r\n\t\t}\r\n\t\ttable{\r\n\t\t\tborder-collapse:collapse;\r\n\t\t}\r\n\t\th1,h2,h3,h4,h5,h6{\r\n\t\t\tdisplay:block;\r\n\t\t\tmargin:0;\r\n\t\t\tpadding:0;\r\n\t\t}\r\n\t\timg,a img{\r\n\t\t\tborder:0;\r\n\t\t\theight:auto;\r\n\t\t\toutline:none;\r\n\t\t\ttext-decoration:none;\r\n\t\t}\r\n\t\tbody,#bodyTable,#bodyCell{\r\n\t\t\theight:100%;\r\n\t\t\tmargin:0;\r\n\t\t\tpadding:0;\r\n\t\t\twidth:100%;\r\n\t\t}\r\n\t\t.mcnPreviewText{\r\n\t\t\tdisplay:none !important;\r\n\t\t}\r\n\t\t#outlook a{\r\n\t\t\tpadding:0;\r\n\t\t}\r\n\t\timg{\r\n\t\t\t-ms-interpolation-mode:bicubic;\r\n\t\t}\r\n\t\ttable{\r\n\t\t\tmso-table-lspace:0pt;\r\n\t\t\tmso-table-rspace:0pt;\r\n\t\t}\r\n\t\t.ReadMsgBody{\r\n\t\t\twidth:100%;\r\n\t\t}\r\n\t\t.ExternalClass{\r\n\t\t\twidth:100%;\r\n\t\t}\r\n\t\tp,a,li,td,blockquote{\r\n\t\t\tmso-line-height-rule:exactly;\r\n\t\t}\r\n\t\ta[href^=tel],a[href^=sms]{\r\n\t\t\tcolor:inherit;\r\n\t\t\tcursor:default;\r\n\t\t\ttext-decoration:none;\r\n\t\t}\r\n\t\tp,a,li,td,body,table,blockquote{\r\n\t\t\t-ms-text-size-adjust:100%;\r\n\t\t\t-webkit-text-size-adjust:100%;\r\n\t\t}\r\n\t\t.ExternalClass,.ExternalClass p,.ExternalClass td,.ExternalClass div,.ExternalClass span,.ExternalClass font{\r\n\t\t\tline-height:100%;\r\n\t\t}\r\n\t\ta[x-apple-data-detectors]{\r\n\t\t\tcolor:inherit !important;\r\n\t\t\ttext-decoration:none !important;\r\n\t\t\tfont-size:inherit !important;\r\n\t\t\tfont-family:inherit !important;\r\n\t\t\tfont-weight:inherit !important;\r\n\t\t\tline-height:inherit !important;\r\n\t\t}\r\n\t\t#bodyCell{\r\n\t\t\tpadding:10px;\r\n\t\t}\r\n\t\t.templateContainer{\r\n\t\t\tmax-width:600px !important;\r\n\t\t\tborder:0;\r\n\t\t}\r\n\t\ta.mcnButton{\r\n\t\t\tdisplay:block;\r\n\t\t}\r\n\t\t.mcnImage,.mcnRetinaImage{\r\n\t\t\tvertical-align:bottom;\r\n\t\t}\r\n\t\t.mcnTextContent{\r\n\t\t\tword-break:break-word;\r\n\t\t}\r\n\t\t.mcnTextContent img{\r\n\t\t\theight:auto !important;\r\n\t\t}\r\n\t\t.mcnDividerBlock{\r\n\t\t\ttable-layout:fixed !important;\r\n\t\t}\r\n\t\tbody,#bodyTable{\r\n\t\t\tbackground-color:#FAFAFA;\r\n\t\t}\r\n\t\t#bodyCell{\r\n\t\t\tborder-top:0;\r\n\t\t}\r\n\t\t.templateContainer{\r\n\t\t\tborder:0;\r\n\t\t}\r\n\t\th1{\r\n\t\t\tcolor:#202020;\r\n\t\t\tfont-family:\"Roboto\", \"Helvetica Neue\", Helvetica, Arial, sans-serif;\r\n\t\t\tfont-size:26px;\r\n\t\t\tfont-style:normal;\r\n\t\t\tfont-weight:bold;\r\n\t\t\tline-height:125%;\r\n\t\t\tletter-spacing:normal;\r\n\t\t\ttext-align:left;\r\n\t\t}\r\n\t\th2{\r\n\t\t\tcolor:#202020;\r\n\t\t\tfont-family:\"Roboto\", \"Helvetica Neue\", Helvetica, Arial, sans-serif;\r\n\t\t\tfont-size:22px;\r\n\t\t\tfont-style:normal;\r\n\t\t\tfont-weight:bold;\r\n\t\t\tline-height:125%;\r\n\t\t\tletter-spacing:normal;\r\n\t\t\ttext-align:left;\r\n\t\t}\r\n\t\th3{\r\n\t\t\tcolor:#202020;\r\n\t\t\tfont-family:\"Roboto\", \"Helvetica Neue\", Helvetica, Arial, sans-serif;\r\n\t\t\tfont-size:20px;\r\n\t\t\tfont-style:normal;\r\n\t\t\tfont-weight:bold;\r\n\t\t\tline-height:125%;\r\n\t\t\tletter-spacing:normal;\r\n\t\t\ttext-align:left;\r\n\t\t}\r\n\t\th4{\r\n\t\t\tcolor:#202020;\r\n\t\t\tfont-family:\"Roboto\", \"Helvetica Neue\", Helvetica, Arial, sans-serif;\r\n\t\t\tfont-size:18px;\r\n\t\t\tfont-style:normal;\r\n\t\t\tfont-weight:bold;\r\n\t\t\tline-height:125%;\r\n\t\t\tletter-spacing:normal;\r\n\t\t\ttext-align:left;\r\n\t\t}\r\n\t\t#templatePreheader{\r\n\t\t\tbackground-color:#FAFAFA;\r\n\t\t\tbackground-image:none;\r\n\t\t\tbackground-repeat:no-repeat;\r\n\t\t\tbackground-position:center;\r\n\t\t\tbackground-size:cover;\r\n\t\t\tborder-top:0;\r\n\t\t\tborder-bottom:0;\r\n\t\t\tpadding-top:9px;\r\n\t\t\tpadding-bottom:9px;\r\n\t\t}\r\n\t\t#templatePreheader .mcnTextContent,#templatePreheader .mcnTextContent p{\r\n\t\t\tcolor:#656565;\r\n\t\t\tfont-family:\"Roboto\", \"Helvetica Neue\", Helvetica, Arial, sans-serif;\r\n\t\t\tfont-size:12px;\r\n\t\t\tline-height:150%;\r\n\t\t\ttext-align:left;\r\n\t\t}\r\n\t\t#templatePreheader .mcnTextContent a,#templatePreheader .mcnTextContent p a{\r\n\t\t\tcolor:#656565;\r\n\t\t\tfont-weight:normal;\r\n\t\t\ttext-decoration:underline;\r\n\t\t}\r\n\t\t#templateHeader{\r\n\t\t\tbackground-color:#ffffff;\r\n\t\t\tbackground-image:none;\r\n\t\t\tbackground-repeat:no-repeat;\r\n\t\t\tbackground-position:center;\r\n\t\t\tbackground-size:cover;\r\n\t\t\tborder-top:1px none ;\r\n\t\t\tborder-bottom:1px none ;\r\n\t\t\tpadding-top:9px;\r\n\t\t\tpadding-bottom:0;\r\n\t\t}\r\n\t\t#templateHeader .mcnTextContent,#templateHeader .mcnTextContent p{\r\n\t\t\tcolor:#202020;\r\n\t\t\tfont-family:\"Roboto\", \"Helvetica Neue\", Helvetica, Arial, sans-serif;\r\n\t\t\tfont-size:16px;\r\n\t\t\tline-height:150%;\r\n\t\t\ttext-align:left;\r\n\t\t}\r\n\t\t#templateHeader .mcnTextContent a,#templateHeader .mcnTextContent p a{\r\n\t\t\tcolor:#007C89;\r\n\t\t\tfont-weight:normal;\r\n\t\t\ttext-decoration:underline;\r\n\t\t}\r\n\t\t#templateBody{\r\n\t\t\tbackground-color:#ffffff;\r\n\t\t\tbackground-image:none;\r\n\t\t\tbackground-repeat:no-repeat;\r\n\t\t\tbackground-position:center;\r\n\t\t\tbackground-size:cover;\r\n\t\t\tborder-top:1px none ;\r\n\t\t\tborder-bottom:2px solid #EAEAEA;\r\n\t\t\tpadding-top:0;\r\n\t\t\tpadding-bottom:9px;\r\n\t\t}\r\n\t\t#templateBody .mcnTextContent,#templateBody .mcnTextContent p{\r\n\t\t\tcolor:#202020;\r\n\t\t\tfont-family:\"Roboto\", \"Helvetica Neue\", Helvetica, Arial, sans-serif;\r\n\t\t\tfont-size:14px;\r\n\t\t\tline-height:150%;\r\n\t\t\ttext-align:left;\r\n\t\t}\r\n\t\t#templateBody .mcnTextContent a,#templateBody .mcnTextContent p a{\r\n\t\t\tcolor:#0098db;\r\n\t\t\tfont-weight:normal;\r\n\t\t\ttext-decoration:underline;\r\n\t\t}\r\n\t\t#templateFooter{\r\n\t\t\tbackground-color:#FAFAFA;\r\n\t\t\tbackground-image:none;\r\n\t\t\tbackground-repeat:no-repeat;\r\n\t\t\tbackground-position:center;\r\n\t\t\tbackground-size:cover;\r\n\t\t\tborder-top:0;\r\n\t\t\tborder-bottom:0;\r\n\t\t\tpadding-top:9px;\r\n\t\t\tpadding-bottom:9px;\r\n\t\t}\r\n\t\t#templateFooter .mcnTextContent,#templateFooter .mcnTextContent p{\r\n\t\t\tcolor:#656565;\r\n\t\t\tfont-family:\"Roboto\", \"Helvetica Neue\", Helvetica, Arial, sans-serif;\r\n\t\t\tfont-size:12px;\r\n\t\t\tline-height:150%;\r\n\t\t\ttext-align:center;\r\n\t\t}\r\n\t\t#templateFooter .mcnTextContent a,#templateFooter .mcnTextContent p a{\r\n\t\t\tcolor:#656565;\r\n\t\t\tfont-weight:normal;\r\n\t\t\ttext-decoration:underline;\r\n\t\t}\r\n\t@media only screen and (min-width:768px){\r\n\t\t.templateContainer{\r\n\t\t\twidth:600px !important;\r\n\t\t}\r\n\r\n}\t@media only screen and (max-width: 480px){\r\n\t\tbody,table,td,p,a,li,blockquote{\r\n\t\t\t-webkit-text-size-adjust:none !important;\r\n\t\t}\r\n\r\n}\t@media only screen and (max-width: 480px){\r\n\t\tbody{\r\n\t\t\twidth:100% !important;\r\n\t\t\tmin-width:100% !important;\r\n\t\t}\r\n\r\n}\t@media only screen and (max-width: 480px){\r\n\t\t#bodyCell{\r\n\t\t\tpadding-top:10px !important;\r\n\t\t}\r\n\r\n}\t@media only screen and (max-width: 480px){\r\n\t\t.mcnRetinaImage{\r\n\t\t\tmax-width:100% !important;\r\n\t\t}\r\n\r\n}\t@media only screen and (max-width: 480px){\r\n\t\t.mcnImage{\r\n\t\t\twidth:100% !important;\r\n\t\t}\r\n\r\n}\t@media only screen and (max-width: 480px){\r\n\t\t.mcnCartContainer,.mcnCaptionTopContent,.mcnRecContentContainer,.mcnCaptionBottomContent,.mcnTextContentContainer,.mcnBoxedTextContentContainer,.mcnImageGroupContentContainer,.mcnCaptionLeftTextContentContainer,.mcnCaptionRightTextContentContainer,.mcnCaptionLeftImageContentContainer,.mcnCaptionRightImageContentContainer,.mcnImageCardLeftTextContentContainer,.mcnImageCardRightTextContentContainer,.mcnImageCardLeftImageContentContainer,.mcnImageCardRightImageContentContainer{\r\n\t\t\tmax-width:100% !important;\r\n\t\t\twidth:100% !important;\r\n\t\t}\r\n\r\n}\t@media only screen and (max-width: 480px){\r\n\t\t.mcnBoxedTextContentContainer{\r\n\t\t\tmin-width:100% !important;\r\n\t\t}\r\n\r\n}\t@media only screen and (max-width: 480px){\r\n\t\t.mcnImageGroupContent{\r\n\t\t\tpadding:9px !important;\r\n\t\t}\r\n\r\n}\t@media only screen and (max-width: 480px){\r\n\t\t.mcnCaptionLeftContentOuter .mcnTextContent,.mcnCaptionRightContentOuter .mcnTextContent{\r\n\t\t\tpadding-top:9px !important;\r\n\t\t}\r\n\r\n}\t@media only screen and (max-width: 480px){\r\n\t\t.mcnImageCardTopImageContent,.mcnCaptionBottomContent:last-child .mcnCaptionBottomImageContent,.mcnCaptionBlockInner .mcnCaptionTopContent:last-child .mcnTextContent{\r\n\t\t\tpadding-top:18px !important;\r\n\t\t}\r\n\r\n}\t@media only screen and (max-width: 480px){\r\n\t\t.mcnImageCardBottomImageContent{\r\n\t\t\tpadding-bottom:9px !important;\r\n\t\t}\r\n\r\n}\t@media only screen and (max-width: 480px){\r\n\t\t.mcnImageGroupBlockInner{\r\n\t\t\tpadding-top:0 !important;\r\n\t\t\tpadding-bottom:0 !important;\r\n\t\t}\r\n\r\n}\t@media only screen and (max-width: 480px){\r\n\t\t.mcnImageGroupBlockOuter{\r\n\t\t\tpadding-top:9px !important;\r\n\t\t\tpadding-bottom:9px !important;\r\n\t\t}\r\n\r\n}\t@media only screen and (max-width: 480px){\r\n\t\t.mcnTextContent,.mcnBoxedTextContentColumn{\r\n\t\t\tpadding-right:18px !important;\r\n\t\t\tpadding-left:18px !important;\r\n\t\t}\r\n\r\n}\t@media only screen and (max-width: 480px){\r\n\t\t.mcnImageCardLeftImageContent,.mcnImageCardRightImageContent{\r\n\t\t\tpadding-right:18px !important;\r\n\t\t\tpadding-bottom:0 !important;\r\n\t\t\tpadding-left:18px !important;\r\n\t\t}\r\n\r\n}\t@media only screen and (max-width: 480px){\r\n\t\t.mcpreview-image-uploader{\r\n\t\t\tdisplay:none !important;\r\n\t\t\twidth:100% !important;\r\n\t\t}\r\n\r\n}\t@media only screen and (max-width: 480px){\r\n\t\th1{\r\n\t\t\tfont-size:22px !important;\r\n\t\t\tline-height:125% !important;\r\n\t\t}\r\n\r\n}\t@media only screen and (max-width: 480px){\r\n\t\th2{\r\n\t\t\tfont-size:20px !important;\r\n\t\t\tline-height:125% !important;\r\n\t\t}\r\n\r\n}\t@media only screen and (max-width: 480px){\r\n\t\th3{\r\n\t\t\tfont-size:18px !important;\r\n\t\t\tline-height:125% !important;\r\n\t\t}\r\n\r\n}\t@media only screen and (max-width: 480px){\r\n\t\th4{\r\n\t\t\tfont-size:16px !important;\r\n\t\t\tline-height:150% !important;\r\n\t\t}\r\n\r\n}\t@media only screen and (max-width: 480px){\r\n\t\t.mcnBoxedTextContentContainer .mcnTextContent,.mcnBoxedTextContentContainer .mcnTextContent p{\r\n\t\t\tfont-size:14px !important;\r\n\t\t\tline-height:150% !important;\r\n\t\t}\r\n\r\n}\t@media only screen and (max-width: 480px){\r\n\t\t#templatePreheader{\r\n\t\t\tdisplay:block !important;\r\n\t\t}\r\n\r\n}\t@media only screen and (max-width: 480px){\r\n\t\t#templatePreheader .mcnTextContent,#templatePreheader .mcnTextContent p{\r\n\t\t\tfont-size:14px !important;\r\n\t\t\tline-height:150% !important;\r\n\t\t}\r\n\r\n}\t@media only screen and (max-width: 480px){\r\n\t\t#templateHeader .mcnTextContent,#templateHeader .mcnTextContent p{\r\n\t\t\tfont-size:16px !important;\r\n\t\t\tline-height:150% !important;\r\n\t\t}\r\n\r\n}\t@media only screen and (max-width: 480px){\r\n\t\t#templateBody .mcnTextContent,#templateBody .mcnTextContent p{\r\n\t\t\tfont-size:16px !important;\r\n\t\t\tline-height:150% !important;\r\n\t\t}\r\n\r\n}\t@media only screen and (max-width: 480px){\r\n\t\t#templateFooter .mcnTextContent,#templateFooter .mcnTextContent p{\r\n\t\t\tfont-size:14px !important;\r\n\t\t\tline-height:150% !important;\r\n\t\t}\r\n\r\n}\r\n\r\n</style><!--[if !mso]><!--><link href=\"https://fonts.googleapis.com/css?family=Roboto:400,400i,700,700i\" rel=\"stylesheet\"><!--<![endif]-->       \r\n                            \r\n        <body style=\"height: 100%;margin: 0;padding: 0;width: 100%;-ms-text-size-adjust: 100%;-webkit-text-size-adjust: 100%;background-color: #FAFAFA;\">\r\n        <!---->\r\n        <center>\r\n            <table align=\"center\" border=\"0\" cellpadding=\"0\" cellspacing=\"0\" height=\"100%\" width=\"100%\" id=\"bodyTable\" style=\"border-collapse: collapse;mso-table-lspace: 0pt;mso-table-rspace: 0pt;-ms-text-size-adjust: 100%;-webkit-text-size-adjust: 100%;height: 100%;margin: 0;padding: 0;width: 100%;background-color: #FAFAFA;\">\r\n                <tr>\r\n                    <td align=\"center\" valign=\"top\" id=\"bodyCell\" style=\"mso-line-height-rule: exactly;-ms-text-size-adjust: 100%;-webkit-text-size-adjust: 100%;height: 100%;margin: 0;padding: 10px;width: 100%;border-top: 0;\">\r\n                        <!-- BEGIN TEMPLATE // -->\r\n                        <!--[if (gte mso 9)|(IE)]>\r\n                        <table align=\"center\" border=\"0\" cellspacing=\"0\" cellpadding=\"0\" width=\"600\" style=\"width:600px;\">\r\n                        <tr>\r\n                        <td align=\"center\" valign=\"top\" width=\"600\" style=\"width:600px;\">\r\n                        <![endif]-->\r\n                        <table border=\"0\" cellpadding=\"0\" cellspacing=\"0\" width=\"100%\" class=\"templateContainer\" style=\"border-collapse: collapse;mso-table-lspace: 0pt;mso-table-rspace: 0pt;-ms-text-size-adjust: 100%;-webkit-text-size-adjust: 100%;border: 0;max-width: 600px !important;\">\r\n                            <tr>\r\n                                <td valign=\"top\" id=\"templatePreheader\" style=\"background:#FAFAFA none no-repeat center/cover;mso-line-height-rule: exactly;-ms-text-size-adjust: 100%;-webkit-text-size-adjust: 100%;background-color: #FAFAFA;background-image: none;background-repeat: no-repeat;background-position: center;background-size: cover;border-top: 0;border-bottom: 0;padding-top: 9px;padding-bottom: 9px;\"><table border=\"0\" cellpadding=\"0\" cellspacing=\"0\" width=\"100%\" class=\"mcnTextBlock\" style=\"min-width: 100%;border-collapse: collapse;mso-table-lspace: 0pt;mso-table-rspace: 0pt;-ms-text-size-adjust: 100%;-webkit-text-size-adjust: 100%;\">\r\n    <tbody class=\"mcnTextBlockOuter\">\r\n        <tr>\r\n            <td valign=\"top\" class=\"mcnTextBlockInner\" style=\"padding-top: 9px;mso-line-height-rule: exactly;-ms-text-size-adjust: 100%;-webkit-text-size-adjust: 100%;\">\r\n              \t<!--[if mso]>\r\n\t\t\t\t<table align=\"left\" border=\"0\" cellspacing=\"0\" cellpadding=\"0\" width=\"100%\" style=\"width:100%;\">\r\n\t\t\t\t<tr>\r\n\t\t\t\t<![endif]-->\r\n\t\t\t    \r\n\t\t\t\t<!--[if mso]>\r\n\t\t\t\t<td valign=\"top\" width=\"599\" style=\"width:599px;\">\r\n\t\t\t\t<![endif]-->\r\n                <table align=\"left\" border=\"0\" cellpadding=\"0\" cellspacing=\"0\" style=\"max-width: 100%;min-width: 100%;border-collapse: collapse;mso-table-lspace: 0pt;mso-table-rspace: 0pt;-ms-text-size-adjust: 100%;-webkit-text-size-adjust: 100%;\" width=\"100%\" class=\"mcnTextContentContainer\">\r\n                    <tbody><tr>\r\n                        \r\n                        <td valign=\"top\" class=\"mcnTextContent\" style=\"padding: 0px 18px 9px;text-align: center;mso-line-height-rule: exactly;-ms-text-size-adjust: 100%;-webkit-text-size-adjust: 100%;word-break: break-word;color: #656565;font-family: Helvetica;font-size: 12px;line-height: 150%;\">\r\n                        \r\n                            <a href=\"https://us4.campaign-archive.com/?e=[UNIQID]&u=3b79c305e48389bbb48dc87dd&id=728a3522cb\" target=\"_blank\" style=\"mso-line-height-rule: exactly;-ms-text-size-adjust: 100%;-webkit-text-size-adjust: 100%;color: #656565;font-weight: normal;text-decoration: underline;\">View this email in your browser</a>\r\n                        </td>\r\n                    </tr>\r\n                </tbody></table>\r\n\t\t\t\t<!--[if mso]>\r\n\t\t\t\t</td>\r\n\t\t\t\t<![endif]-->\r\n                \r\n\t\t\t\t<!--[if mso]>\r\n\t\t\t\t</tr>\r\n\t\t\t\t</table>\r\n\t\t\t\t<![endif]-->\r\n            </td>\r\n        </tr>\r\n    </tbody>\r\n</table></td>\r\n                            </tr>\r\n                            <tr>\r\n                                <td valign=\"top\" id=\"templateHeader\" style=\"background:#ffffff none no-repeat center/cover;mso-line-height-rule: exactly;-ms-text-size-adjust: 100%;-webkit-text-size-adjust: 100%;background-color: #ffffff;background-image: none;background-repeat: no-repeat;background-position: center;background-size: cover;border-top: 1px none;border-bottom: 1px none;padding-top: 9px;padding-bottom: 0;\"><table border=\"0\" cellpadding=\"0\" cellspacing=\"0\" width=\"100%\" class=\"mcnImageBlock\" style=\"min-width: 100%;border-collapse: collapse;mso-table-lspace: 0pt;mso-table-rspace: 0pt;-ms-text-size-adjust: 100%;-webkit-text-size-adjust: 100%;\">\r\n    <tbody class=\"mcnImageBlockOuter\">\r\n            <tr>\r\n                <td valign=\"top\" style=\"padding: 9px;mso-line-height-rule: exactly;-ms-text-size-adjust: 100%;-webkit-text-size-adjust: 100%;\" class=\"mcnImageBlockInner\">\r\n                    <table align=\"left\" width=\"100%\" border=\"0\" cellpadding=\"0\" cellspacing=\"0\" class=\"mcnImageContentContainer\" style=\"min-width: 100%;border-collapse: collapse;mso-table-lspace: 0pt;mso-table-rspace: 0pt;-ms-text-size-adjust: 100%;-webkit-text-size-adjust: 100%;\">\r\n                        <tbody><tr>\r\n                            <td class=\"mcnImageContent\" valign=\"top\" style=\"padding-right: 9px;padding-left: 9px;padding-top: 0;padding-bottom: 0;mso-line-height-rule: exactly;-ms-text-size-adjust: 100%;-webkit-text-size-adjust: 100%;\">\r\n                                \r\n                                    \r\n                                        <img align=\"left\" alt=\"\" src=\"https://mcusercontent.com/3b79c305e48389bbb48dc87dd/images/2c3e0416-3e76-4455-83b6-b16833cead34.png\" width=\"237.51\" style=\"max-width: 377px;padding-bottom: 0px;vertical-align: bottom;display: inline !important;border: 1px none;height: auto;outline: none;text-decoration: none;-ms-interpolation-mode: bicubic;\" class=\"mcnImage\">\r\n                                    \r\n                                \r\n                            </td>\r\n                        </tr>\r\n                    </tbody></table>\r\n                </td>\r\n            </tr>\r\n    </tbody>\r\n</table></td>\r\n                            </tr>\r\n                            <tr>\r\n                                <td valign=\"top\" id=\"templateBody\" style=\"background:#ffffff none no-repeat center/cover;mso-line-height-rule: exactly;-ms-text-size-adjust: 100%;-webkit-text-size-adjust: 100%;background-color: #ffffff;background-image: none;background-repeat: no-repeat;background-position: center;background-size: cover;border-top: 1px none;border-bottom: 2px solid #EAEAEA;padding-top: 0;padding-bottom: 9px;\"><table border=\"0\" cellpadding=\"0\" cellspacing=\"0\" width=\"100%\" class=\"mcnTextBlock\" style=\"min-width: 100%;border-collapse: collapse;mso-table-lspace: 0pt;mso-table-rspace: 0pt;-ms-text-size-adjust: 100%;-webkit-text-size-adjust: 100%;\">\r\n    <tbody class=\"mcnTextBlockOuter\">\r\n        <tr>\r\n            <td valign=\"top\" class=\"mcnTextBlockInner\" style=\"padding-top: 9px;mso-line-height-rule: exactly;-ms-text-size-adjust: 100%;-webkit-text-size-adjust: 100%;\">\r\n              \t<!--[if mso]>\r\n\t\t\t\t<table align=\"left\" border=\"0\" cellspacing=\"0\" cellpadding=\"0\" width=\"100%\" style=\"width:100%;\">\r\n\t\t\t\t<tr>\r\n\t\t\t\t<![endif]-->\r\n\t\t\t    \r\n\t\t\t\t<!--[if mso]>\r\n\t\t\t\t<td valign=\"top\" width=\"600\" style=\"width:600px;\">\r\n\t\t\t\t<![endif]-->\r\n                <table align=\"left\" border=\"0\" cellpadding=\"0\" cellspacing=\"0\" style=\"max-width: 100%;min-width: 100%;border-collapse: collapse;mso-table-lspace: 0pt;mso-table-rspace: 0pt;-ms-text-size-adjust: 100%;-webkit-text-size-adjust: 100%;\" width=\"100%\" class=\"mcnTextContentContainer\">\r\n                    <tbody><tr>\r\n                        \r\n                        <td valign=\"top\" class=\"mcnTextContent\" style=\"padding: 0px 18px 9px;font-family: Roboto, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif;mso-line-height-rule: exactly;-ms-text-size-adjust: 100%;-webkit-text-size-adjust: 100%;word-break: break-word;color: #202020;font-size: 14px;line-height: 150%;text-align: left;\">\r\n                        \r\n                            <p class=\"null\" style=\"font-family: Roboto, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif;margin: 10px 0;padding: 0;mso-line-height-rule: exactly;-ms-text-size-adjust: 100%;-webkit-text-size-adjust: 100%;color: #202020;font-size: 14px;line-height: 150%;text-align: left;\"><strong><span style=\"font-family:roboto,helvetica neue,helvetica,arial,sans-serif\">A new&nbsp;error has occurred:</span></strong><br> \r\n                            \r\n<span style=\"font-family:roboto,helvetica neue,helvetica,arial,sans-serif\"><b>Time of Occurence: </b> {{ErrorDateTime}}</span><br>\r\n\r\n\r\n<span style=\"font-family:roboto,helvetica neue,helvetica,arial,sans-serif\"><b>Plant Name: </b>{{PlantName}}</span><br>\r\n<!--\r\nPlant Contact<br>\r\n<span style=\"color:#A9A9A9\">Name:</span>&nbsp;{{firstName}} {{lastName}}<br>\r\n<span style=\"color:#A9A9A9\">Phone:</span>&nbsp;{{contactPhone}}<br>\r\n<span style=\"color:#A9A9A9\">Email:</span> <a href=\"http://hach.com\" target=\"_blank\" style=\"mso-line-height-rule: exactly;-ms-text-size-adjust: 100%;-webkit-text-size-adjust: 100%;color: #0098db;font-weight: normal;text-decoration: underline;\">{{contactEmail}}</a><br>\r\n-->\r\n&nbsp;</p>\r\n\r\n<hr>\r\n<p style=\"font-family: Roboto, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif;margin: 10px 0;padding: 0;mso-line-height-rule: exactly;-ms-text-size-adjust: 100%;-webkit-text-size-adjust: 100%;color: #202020;font-size: 14px;line-height: 150%;text-align: left;\"><span style=\"font-family:roboto,helvetica neue,helvetica,arial,sans-serif\"><span style=\"color:#A9A9A9\"><img align=\"left\" data-file-id=\"13012508\" height=\"50\" src=\"https://mcusercontent.com/3b79c305e48389bbb48dc87dd/images/faff3031-ddb4-4b5d-98f7-be871e68ee2d.png\" style=\"border: 0px;width: 50px;height: 50px;margin: 0px 15px 15px 0px;outline: none;text-decoration: none;-ms-interpolation-mode: bicubic;\" width=\"50\">Device name:</span>&nbsp;{{DeviceName}}&nbsp;<br>\r\n<span style=\"color:#A9A9A9\">Device type:</span>&nbsp;{{DeviceType}}<br>\r\n<span style=\"color:#A9A9A9\">Serial number:</span>&nbsp;{{SerialNumber}}</span></p>\r\n<br>\r\n<img align=\"left\" data-file-id=\"12989632\" height=\"50\" src=\"https://mcusercontent.com/3b79c305e48389bbb48dc87dd/images/018528ed-c2c3-40d4-905f-f0680faca85c.png\" style=\"border: 0px;width: 50px;height: 50px;margin: 0px 15px 15px 0px;outline: none;text-decoration: none;-ms-interpolation-mode: bicubic;\" width=\"50\"><strong><span style=\"color:#B22222\">Error Reported</span></strong><br>\r\n<ul>{{#each ErrorMessage}} <li>{{this}}</li> {{/each}} </ul><br>\r\n<br>\r\n&nbsp;\r\n                        </td>\r\n                    </tr>\r\n                </tbody></table>\r\n\t\t\t\t<!--[if mso]>\r\n\t\t\t\t</td>\r\n\t\t\t\t<![endif]-->\r\n                \r\n\t\t\t\t<!--[if mso]>\r\n\t\t\t\t</tr>\r\n\t\t\t\t</table>\r\n\t\t\t\t<![endif]-->\r\n            </td>\r\n        </tr>\r\n    </tbody>\r\n</table><table border=\"0\" cellpadding=\"0\" cellspacing=\"0\" width=\"100%\" class=\"mcnDividerBlock\" style=\"min-width: 100%;border-collapse: collapse;mso-table-lspace: 0pt;mso-table-rspace: 0pt;-ms-text-size-adjust: 100%;-webkit-text-size-adjust: 100%;table-layout: fixed !important;\">\r\n    <tbody class=\"mcnDividerBlockOuter\">\r\n        <tr>\r\n            <td class=\"mcnDividerBlockInner\" style=\"min-width: 100%;padding: 18px;mso-line-height-rule: exactly;-ms-text-size-adjust: 100%;-webkit-text-size-adjust: 100%;\">\r\n                <table class=\"mcnDividerContent\" border=\"0\" cellpadding=\"0\" cellspacing=\"0\" width=\"100%\" style=\"min-width: 100%;border-top: 2px solid #EAEAEA;border-collapse: collapse;mso-table-lspace: 0pt;mso-table-rspace: 0pt;-ms-text-size-adjust: 100%;-webkit-text-size-adjust: 100%;\">\r\n                    <tbody><tr>\r\n                        <td style=\"mso-line-height-rule: exactly;-ms-text-size-adjust: 100%;-webkit-text-size-adjust: 100%;\">\r\n                            <span></span>\r\n                        </td>\r\n                    </tr>\r\n                </tbody></table>\r\n<!--            \r\n                <td class=\"mcnDividerBlockInner\" style=\"padding: 18px;\">\r\n                <hr class=\"mcnDividerContent\" style=\"border-bottom-color:none; border-left-color:none; border-right-color:none; border-bottom-width:0; border-left-width:0; border-right-width:0; margin-top:0; margin-right:0; margin-bottom:0; margin-left:0;\" />\r\n-->\r\n            </td>\r\n        </tr>\r\n    </tbody>\r\n</table><table border=\"0\" cellpadding=\"0\" cellspacing=\"0\" width=\"100%\" class=\"mcnButtonBlock\" style=\"min-width: 100%;border-collapse: collapse;mso-table-lspace: 0pt;mso-table-rspace: 0pt;-ms-text-size-adjust: 100%;-webkit-text-size-adjust: 100%;\">\r\n    <tbody class=\"mcnButtonBlockOuter\">\r\n        <tr>\r\n            <td style=\"padding-top: 0;padding-right: 18px;padding-bottom: 18px;padding-left: 18px;mso-line-height-rule: exactly;-ms-text-size-adjust: 100%;-webkit-text-size-adjust: 100%;\" valign=\"top\" align=\"center\" class=\"mcnButtonBlockInner\">\r\n                <table border=\"0\" cellpadding=\"0\" cellspacing=\"0\" width=\"100%\" class=\"mcnButtonContentContainer\" style=\"border-collapse: separate !important;border-radius: 5px;background-color: #0098DB;mso-table-lspace: 0pt;mso-table-rspace: 0pt;-ms-text-size-adjust: 100%;-webkit-text-size-adjust: 100%;\">\r\n                    <tbody>\r\n                        <tr>\r\n                            <td align=\"center\" valign=\"middle\" class=\"mcnButtonContent\" style=\"font-family: Roboto, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif;font-size: 16px;padding: 16px;mso-line-height-rule: exactly;-ms-text-size-adjust: 100%;-webkit-text-size-adjust: 100%;\">\r\n                                <a class=\"mcnButton \" title=\"View in Claros\" href=\"http://hach.com\" target=\"_blank\" style=\"font-weight: bold;letter-spacing: normal;line-height: 100%;text-align: center;text-decoration: none;color: #FFFFFF;mso-line-height-rule: exactly;-ms-text-size-adjust: 100%;-webkit-text-size-adjust: 100%;display: block;\">View in Claros</a>\r\n                            </td>\r\n                        </tr>\r\n                    </tbody>\r\n                </table>\r\n            </td>\r\n        </tr>\r\n    </tbody>\r\n</table></td>\r\n                            </tr>\r\n                            <tr>\r\n                                <td valign=\"top\" id=\"templateFooter\" style=\"background:#FAFAFA none no-repeat center/cover;mso-line-height-rule: exactly;-ms-text-size-adjust: 100%;-webkit-text-size-adjust: 100%;background-color: #FAFAFA;background-image: none;background-repeat: no-repeat;background-position: center;background-size: cover;border-top: 0;border-bottom: 0;padding-top: 9px;padding-bottom: 9px;\"><table border=\"0\" cellpadding=\"0\" cellspacing=\"0\" width=\"100%\" class=\"mcnDividerBlock\" style=\"min-width: 100%;border-collapse: collapse;mso-table-lspace: 0pt;mso-table-rspace: 0pt;-ms-text-size-adjust: 100%;-webkit-text-size-adjust: 100%;table-layout: fixed !important;\">\r\n    <tbody class=\"mcnDividerBlockOuter\">\r\n        <tr>\r\n            <td class=\"mcnDividerBlockInner\" style=\"min-width: 100%;padding: 10px 18px 25px;mso-line-height-rule: exactly;-ms-text-size-adjust: 100%;-webkit-text-size-adjust: 100%;\">\r\n                <table class=\"mcnDividerContent\" border=\"0\" cellpadding=\"0\" cellspacing=\"0\" width=\"100%\" style=\"min-width: 100%;border-top: 2px solid #EEEEEE;border-collapse: collapse;mso-table-lspace: 0pt;mso-table-rspace: 0pt;-ms-text-size-adjust: 100%;-webkit-text-size-adjust: 100%;\">\r\n                    <tbody><tr>\r\n                        <td style=\"mso-line-height-rule: exactly;-ms-text-size-adjust: 100%;-webkit-text-size-adjust: 100%;\">\r\n                            <span></span>\r\n                        </td>\r\n                    </tr>\r\n                </tbody></table>\r\n<!--            \r\n                <td class=\"mcnDividerBlockInner\" style=\"padding: 18px;\">\r\n                <hr class=\"mcnDividerContent\" style=\"border-bottom-color:none; border-left-color:none; border-right-color:none; border-bottom-width:0; border-left-width:0; border-right-width:0; margin-top:0; margin-right:0; margin-bottom:0; margin-left:0;\" />\r\n-->\r\n            </td>\r\n        </tr>\r\n    </tbody>\r\n</table><table border=\"0\" cellpadding=\"0\" cellspacing=\"0\" width=\"100%\" class=\"mcnTextBlock\" style=\"min-width: 100%;border-collapse: collapse;mso-table-lspace: 0pt;mso-table-rspace: 0pt;-ms-text-size-adjust: 100%;-webkit-text-size-adjust: 100%;\">\r\n    <tbody class=\"mcnTextBlockOuter\">\r\n        <tr>\r\n            <td valign=\"top\" class=\"mcnTextBlockInner\" style=\"padding-top: 9px;mso-line-height-rule: exactly;-ms-text-size-adjust: 100%;-webkit-text-size-adjust: 100%;\">\r\n              \t<!--[if mso]>\r\n\t\t\t\t<table align=\"left\" border=\"0\" cellspacing=\"0\" cellpadding=\"0\" width=\"100%\" style=\"width:100%;\">\r\n\t\t\t\t<tr>\r\n\t\t\t\t<![endif]-->\r\n\t\t\t    \r\n\t\t\t\t<!--[if mso]>\r\n\t\t\t\t<td valign=\"top\" width=\"599\" style=\"width:599px;\">\r\n\t\t\t\t<![endif]-->\r\n                <table align=\"left\" border=\"0\" cellpadding=\"0\" cellspacing=\"0\" style=\"max-width: 100%;min-width: 100%;border-collapse: collapse;mso-table-lspace: 0pt;mso-table-rspace: 0pt;-ms-text-size-adjust: 100%;-webkit-text-size-adjust: 100%;\" width=\"100%\" class=\"mcnTextContentContainer\">\r\n                    <tbody><tr>\r\n                        \r\n                        <td valign=\"top\" class=\"mcnTextContent\" style=\"padding-top: 0;padding-right: 18px;padding-bottom: 9px;padding-left: 18px;mso-line-height-rule: exactly;-ms-text-size-adjust: 100%;-webkit-text-size-adjust: 100%;word-break: break-word;color: #656565;font-family: Helvetica;font-size: 12px;line-height: 150%;text-align: center;\">\r\n                        \r\n                            <em>Copyright 2020 Hach | PO Box 389, Loveland, CO 80539 | 800-227-4224 | 970-669-3050</em><br>\r\n<br>\r\n<br>\r\nWant to change how you receive these emails?<br>\r\nYou can <a href=\"targetAccountSettings\" style=\"mso-line-height-rule: exactly;-ms-text-size-adjust: 100%;-webkit-text-size-adjust: 100%;color: #656565;font-weight: normal;text-decoration: underline;\">update your preferences</a>.<br>\r\n<br>\r\n \r\n                        </td>\r\n                    </tr>\r\n                </tbody></table>\r\n\t\t\t\t<!--[if mso]>\r\n\t\t\t\t</td>\r\n\t\t\t\t<![endif]-->\r\n                \r\n\t\t\t\t<!--[if mso]>\r\n\t\t\t\t</tr>\r\n\t\t\t\t</table>\r\n\t\t\t\t<![endif]-->\r\n            </td>\r\n        </tr>\r\n    </tbody>\r\n</table></td>\r\n                            </tr>\r\n                        </table>\r\n                        <!--[if (gte mso 9)|(IE)]>\r\n                        </td>\r\n                        </tr>\r\n                        </table>\r\n                        <![endif]-->\r\n                        <!-- // END TEMPLATE -->\r\n                    </td>\r\n                </tr>\r\n            </table>\r\n        </center>\r\n    </body>   </body> </html>";
        private static Dictionary<string, string> templateVariableValues = new Dictionary<string, string>
            {
                { "PlantName", "Germany" },
                { "DeviceType", "England" },
                { "ErrorMessage", "error1,error2,erro3" }
            };
        #endregion
        static void Main()
        {
            Console.WriteLine("Welcome to Mustache - The Logic-less templates");

            MustacheTrials();
        }

        private static void MustacheTrials()
        {
            var compiler = new FormatCompiler();
            var generator1 = compiler.Compile(templateTextToRender);

            string templateTextModified = generator1.Render(new
            {
                ErrorMessage = templateVariableValues["ErrorMessage"].Split(',').ToList()
            });

            templateVariableValues.Remove("ErrorMessage");

            var generator = compiler.Compile(templateTextModified);
            var result = generator.Render(templateVariableValues);

            Console.WriteLine(result);
        }
    }
}
